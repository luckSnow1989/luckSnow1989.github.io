<div class="post">
     <h3 class="title"><span>[Google Guava] 1.2-前置条件</span></h3>
     <div class="post_content">
      <p><a href="http://code.google.com/p/guava-libraries/wiki/PreconditionsExplained" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/PreconditionsExplained'); return false;">原文链接</a>&nbsp;<a href="http://ifeve.com/?p=8798" onclick="javascript:window.open('http://ifeve.com/?p=8798'); return false;">译文链接</a>&nbsp;<strong>译者:</strong> 沈义扬</p>
<p>前置条件：让方法调用的前置条件判断更简单。</p>
<p>Guava在<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html'); return false;">Preconditions</a>类中提供了若干前置条件判断的实用方法，我们强烈建议<a href="http://ifeve.com/eclipse-static-import/" onclick="javascript:window.open('http://ifeve.com/eclipse-static-import/'); return false;">在Eclipse中静态导入这些方法</a>。每个方法都有三个变种：</p>
<ul>
<li>没有额外参数：抛出的异常中没有错误消息；</li>
<li>有一个Object对象作为额外参数：抛出的异常使用Object.toString() 作为错误消息；</li>
<li>有一个String对象作为额外参数，并且有一组任意数量的附加Object对象：这个变种处理异常消息的方式有点类似printf，但考虑GWT的兼容性和效率，只支持%s指示符。例如：</li>
</ul>
<div id="highlighter_898244" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_898244_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_898244" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">checkArgument(i &gt;= </code><code class="value">0</code><code class="plain">, </code><code class="string">"Argument was %s but expected nonnegative"</code><code class="plain">, i);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">checkArgument(i &lt; j, </code><code class="string">"Expected i &lt; j, but %s &gt; %s"</code><code class="plain">, i, j);</code></td></tr></tbody></table></div></div></div>
<p><span id="more-8798"></span></p>
<table border="1" width="631" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="199"><b>方法声明（不包括额外参数）</b><b></b></td>
<td valign="top" width="222"><b>描述</b><b></b></td>
<td valign="top" width="210"><b>检查失败时抛出的异常</b><b></b></td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkArgument(boolean)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkArgument(boolean)'); return false;"><tt>checkArgument(boolean)</tt></a></td>
<td width="222">检查boolean是否为true，用来检查传递给方法的参数。</td>
<td width="210">IllegalArgumentException</td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkNotNull(T)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkNotNull(T)'); return false;"><tt>checkNotNull(T)</tt></a></td>
<td width="222">检查value是否为null，该方法直接返回value，因此可以内嵌使用checkNotNull<tt>。</tt></td>
<td width="210">NullPointerException</td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkState(boolean)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkState(boolean)'); return false;"><tt>checkState(boolean)</tt></a></td>
<td width="222">用来检查对象的某些状态。</td>
<td width="210">IllegalStateException</td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkElementIndex(int, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkElementIndex(int, int)'); return false;"><tt>checkElementIndex(int index, int size)</tt></a></td>
<td width="222">检查index作为索引值对某个列表、字符串或数组是否有效。index&gt;=0 &amp;&amp; index&lt;size *</td>
<td width="210">IndexOutOfBoundsException</td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkPositionIndex(int, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkPositionIndex(int, int)'); return false;"><tt>checkPositionIndex(int index, int size)</tt></a></td>
<td width="222">检查index作为位置值对某个列表、字符串或数组是否有效。index&gt;=0 &amp;&amp; index&lt;=size *</td>
<td width="210">IndexOutOfBoundsException</td>
</tr>
<tr>
<td width="199"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkPositionIndexes(int, int, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkPositionIndexes(int, int, int)'); return false;"><tt>checkPositionIndexes(int start, int end, int size)</tt></a></td>
<td width="222">检查[start, end]表示的位置范围对某个列表、字符串或数组是否有效*</td>
<td width="210">IndexOutOfBoundsException</td>
</tr>
</tbody>
</table>
<p><em>译者注：</em><i></i></p>
<p><i>*</i><i>索引值常用来查找列表、字符串或数组中的元素，如</i><i>List.get(int), String.charAt(int)</i><i></i></p>
<p><em>*位置值和位置范围常用来截取列表、字符串或数组，如List.subList(int，int), String.substring(int)</em></p>
<p>相比Apache Commons提供的类似方法，我们把Guava中的Preconditions作为首选。Piotr Jagielski在<a href="http://piotrjagielski.com/blog/google-guava-vs-apache-commons-for-argument-validation/" onclick="javascript:window.open('http://piotrjagielski.com/blog/google-guava-vs-apache-commons-for-argument-validation/'); return false;">他的博客</a>中简要地列举了一些理由：</p>
<ul>
<li>在静态导入后，Guava方法非常清楚明晰。checkNotNull清楚地描述做了什么，会抛出什么异常；</li>
<li>checkNotNull直接返回检查的参数，让你可以在构造函数中保持字段的单行赋值风格：this.field = checkNotNull(field)</li>
<li>简单的、参数可变的printf风格异常信息。鉴于这个优点，在JDK7已经引入<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html#requireNonNull(java.lang.Object,java.lang.String)" onclick="javascript:window.open('http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html#requireNonNull(java.lang.Object,java.lang.String)'); return false;">Objects.requireNonNull</a>的情况下，我们仍然建议你使用checkNotNull。</li>
</ul>
<p><i>在编码时，如果某个值有多重的前置条件，我们建议你把它们放到不同的行，这样有助于在调试时定位。此外，把每个前置条件放到不同的行，也可以帮助你编写清晰和有用的错误消息。</i><i></i>
</p><div style="margin-top: 15px; font-style: italic">
