<div class="post">
     <h3 class="title"><span>[Google Guava] 8-区间</span></h3>
     <div class="post_content">
      <p><a href="http://code.google.com/p/guava-libraries/wiki/RangesExplained" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/RangesExplained'); return false;">原文链接</a>&nbsp;<a href="http://ifeve.com/google-guava-ranges" onclick="javascript:window.open('http://ifeve.com/google-guava-ranges'); return false;">译文链接</a>&nbsp;<strong>译文：</strong>沈义扬</p>
<h2>范例</h2>
<div id="highlighter_442765" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_442765_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_442765" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List scores;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Iterable belowMedian =Iterables.filter(scores,Range.lessThan(median));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range validGrades = Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">12</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="keyword">for</code><code class="plain">(</code><code class="keyword">int</code> <code class="plain">grade : ContiguousSet.create(validGrades, DiscreteDomain.integers())) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<h2>简介</h2>
<p>区间，有时也称为范围，是特定域中的凸性（非正式说法为连续的或不中断的）部分。在形式上，凸性表示对a&lt;=b&lt;=c, range.contains(a)且range.contains(c)意味着range.contains(b)。<span id="more-8992"></span></p>
<p>区间可以延伸至无限——例如，范围”x&gt;3″包括任意大于3的值——也可以被限制为有限，如” 2&lt;=x&lt;5″。Guava用更紧凑的方法表示范围，有数学背景的程序员对此是耳熟能详的：</p>
<ul>
<li>(a..b) = {x | a &lt; x &lt; b}</li>
<li>[a..b] = {x | a &lt;= x &lt;= b}</li>
<li>[a..b) = {x | a &lt;= x &lt; b}</li>
<li>(a..b] = {x | a &lt; x &lt;= b}</li>
<li>(a..+∞) = {x | x &gt; a}</li>
<li>[a..+∞) = {x | x &gt;= a}</li>
<li>(-∞..b) = {x | x &lt; b}</li>
<li>(-∞..b] = {x | x &lt;= b}</li>
<li>(-∞..+∞) = 所有值</li>
</ul>
<p>上面的a、b称为端点 。为了提高一致性，Guava中的Range要求上端点不能小于下端点。上下端点有可能是相等的，但要求区间是闭区间或半开半闭区间（至少有一个端点是包含在区间中的）：</p>
<ul>
<li>[a..a]：单元素区间</li>
<li>[a..a); (a..a]：空区间，但它们是有效的</li>
<li>(a..a)：无效区间</li>
</ul>
<p>Guava用类型<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html'); return false;">Range&lt;C&gt;</a>表示区间。所有区间实现都是不可变类型。</p>
<h2>构建区间</h2>
<p>区间实例可以由<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html'); return false;">Range</a>类的静态方法获取：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="312">(a..b)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#open(java.lang.Comparable,java.lang.Comparable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#open(java.lang.Comparable,java.lang.Comparable)'); return false;">open(C, C)</a></td>
</tr>
<tr>
<td width="312">[a..b]</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#closed(java.lang.Comparable,java.lang.Comparable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#closed(java.lang.Comparable,java.lang.Comparable)'); return false;">closed(C, C)</a></td>
</tr>
<tr>
<td width="312">[a..b)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#closedOpen(java.lang.Comparable,java.lang.Comparable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#closedOpen(java.lang.Comparable,java.lang.Comparable)'); return false;">closedOpen(C, C)</a></td>
</tr>
<tr>
<td width="312">(a..b]</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#openClosed(java.lang.Comparable,java.lang.Comparable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#openClosed(java.lang.Comparable,java.lang.Comparable)'); return false;">openClosed(C, C)</a></td>
</tr>
<tr>
<td width="312">(a..+∞)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#greaterThan(C)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#greaterThan(C)'); return false;">greaterThan(C)</a></td>
</tr>
<tr>
<td width="312">[a..+∞)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#atLeast(C)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#atLeast(C)'); return false;">atLeast(C)</a></td>
</tr>
<tr>
<td width="312">(-∞..b)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lessThan(C)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lessThan(C)'); return false;">lessThan(C)</a></td>
</tr>
<tr>
<td width="312">(-∞..b]</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#atMost(C)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#atMost(C)'); return false;">atMost(C)</a></td>
</tr>
<tr>
<td width="312">(-∞..+∞)</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#all()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#all()'); return false;">all()</a></td>
</tr>
</tbody>
</table>
<div id="highlighter_448676" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_448676_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_448676" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closed(</code><code class="string">"left"</code><code class="plain">, </code><code class="string">"right"</code><code class="plain">); </code><code class="comments">//字典序在"left"和"right"之间的字符串，闭区间</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.lessThan(</code><code class="value">4.0</code><code class="plain">); </code><code class="comments">//严格小于4.0的double值</code></td></tr></tbody></table></div></div></div>
<p>此外，也可以明确地指定边界类型来构造区间：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="312">有界区间</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#range(java.lang.Comparable,com.google.common.collect.BoundType,java.lang.Comparable,com.google.common.collect.BoundType)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#range(java.lang.Comparable,com.google.common.collect.BoundType,java.lang.Comparable,com.google.common.collect.BoundType)'); return false;">range(C, BoundType, C, &nbsp; BoundType)</a></td>
</tr>
<tr>
<td width="312">无上界区间：((a..+∞) 或[a..+∞))</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#downTo(java.lang.Comparable,com.google.common.collect.BoundType)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#downTo(java.lang.Comparable,com.google.common.collect.BoundType)'); return false;">downTo(C, BoundType)</a></td>
</tr>
<tr>
<td width="312">无下界区间：((-∞..b) 或(-∞..b])</td>
<td width="302"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upTo(java.lang.Comparable,com.google.common.collect.BoundType)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upTo(java.lang.Comparable,com.google.common.collect.BoundType)'); return false;">upTo(C, BoundType)</a></td>
</tr>
</tbody>
</table>
<p>这里的<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/BoundType.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/BoundType.html'); return false;">BoundType</a>是一个枚举类型，包含CLOSED和OPEN两个值。</p>
<div id="highlighter_78906" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_78906_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_78906" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.downTo(</code><code class="value">4</code><code class="plain">, boundType);</code><code class="comments">// (a..+∞)或[a..+∞)，取决于boundType</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.range(</code><code class="value">1</code><code class="plain">, CLOSED, </code><code class="value">4</code><code class="plain">, OPEN);</code><code class="comments">// [1..4)，等同于Range.closedOpen(1, 4)</code></td></tr></tbody></table></div></div></div>
<h2>区间运算</h2>
<p>Range的基本运算是它的<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#contains(C)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#contains(C)'); return false;">contains(C)</a> 方法，和你期望的一样，它用来区间判断是否包含某个值。此外，Range实例也可以当作Predicate，并且在函数式编程中使用（译者注：见第4章）。任何Range实例也都支持containsAll(Iterable&lt;? extends C&gt;)方法：</p>
<div id="highlighter_938837" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_938837_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_938837" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">3</code><code class="plain">).contains(</code><code class="value">2</code><code class="plain">);</code><code class="comments">//return true</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">3</code><code class="plain">).contains(</code><code class="value">4</code><code class="plain">);</code><code class="comments">//return false</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Range.lessThan(</code><code class="value">5</code><code class="plain">).contains(</code><code class="value">5</code><code class="plain">); </code><code class="comments">//return false</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">4</code><code class="plain">).containsAll(Ints.asList(</code><code class="value">1</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="value">3</code><code class="plain">)); </code><code class="comments">//return true</code></td></tr></tbody></table></div></div></div>
<h3>查询运算</h3>
<p>Range类提供了以下方法来 查看区间的端点：</p>
<ul>
<li><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#hasLowerBound()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#hasLowerBound()'); return false;">hasLowerBound()</a>和<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#hasUpperBound()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#hasUpperBound()'); return false;">hasUpperBound()</a>：判断区间是否有特定边界，或是无限的；</li>
<li><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lowerBoundType()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lowerBoundType()'); return false;">lowerBoundType()</a>和<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upperBoundType()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upperBoundType()'); return false;">upperBoundType()</a>：返回区间边界类型，CLOSED或OPEN；如果区间没有对应的边界，抛出IllegalStateException；</li>
<li><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lowerEndpoint()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#lowerEndpoint()'); return false;">lowerEndpoint()</a>和<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upperEndpoint()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#upperEndpoint()'); return false;">upperEndpoint()</a>：返回区间的端点值；如果区间没有对应的边界，抛出IllegalStateException；</li>
<li><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Range.html#isEmpty()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Range.html#isEmpty()'); return false;">isEmpty()</a>：判断是否为空区间。</li>
</ul>
<div id="highlighter_708251" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_708251_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_708251" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closedOpen(</code><code class="value">4</code><code class="plain">, </code><code class="value">4</code><code class="plain">).isEmpty(); </code><code class="comments">// returns true</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.openClosed(</code><code class="value">4</code><code class="plain">, </code><code class="value">4</code><code class="plain">).isEmpty(); </code><code class="comments">// returns true</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">4</code><code class="plain">, </code><code class="value">4</code><code class="plain">).isEmpty(); </code><code class="comments">// returns false</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">4</code><code class="plain">, </code><code class="value">4</code><code class="plain">).isEmpty(); </code><code class="comments">// Range.open throws IllegalArgumentException</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">10</code><code class="plain">).lowerEndpoint(); </code><code class="comments">// returns 3</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">3</code><code class="plain">, </code><code class="value">10</code><code class="plain">).lowerEndpoint(); </code><code class="comments">// returns 3</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">10</code><code class="plain">).lowerBoundType(); </code><code class="comments">// returns CLOSED</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">3</code><code class="plain">, </code><code class="value">10</code><code class="plain">).upperBoundType(); </code><code class="comments">// returns OPEN</code></td></tr></tbody></table></div></div></div>
<h3>关系运算</h3>
<p><strong>包含[enclose]</strong></p>
<p>区间之间的最基本关系就是包含[<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#encloses(com.google.common.collect.Range)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#encloses(com.google.common.collect.Range)'); return false;"><tt>encloses(Range)</tt></a>]：如果内区间的边界没有超出外区间的边界，则外区间包含内区间。包含判断的结果完全取决于区间端点的比较！</p>
<ul>
<li>[3..6] 包含[4..5] ；</li>
<li>(3..6) 包含(3..6) ；</li>
<li>[3..6] 包含[4..4)，虽然后者是空区间；</li>
<li>(3..6]不 包含[3..6] ；</li>
<li>[4..5]不 包含(3..6)，虽然前者包含了后者的所有值，离散域[discrete domains]可以解决这个问题（见8.5节）；</li>
<li>[3..6]不 包含(1..1]，虽然前者包含了后者的所有值。</li>
</ul>
<p>包含是一种<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#partial_ordering" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#partial_ordering'); return false;">偏序关系</a>[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#partial_ordering" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#partial_ordering'); return false;">partial ordering</a>]。基于包含关系的概念，Range还提供了以下运算方法。</p>
<p><strong>相连[isConnected]</strong></p>
<p><tt><span style="text-decoration: underline;">Range.isConnected(Range)</span></tt>判断区间是否是相连的。具体来说，isConnected测试是否有区间同时包含于这两个区间，这等同于数学上的定义”两个区间的并集是连续集合的形式”（空区间的特殊情况除外）。</p>
<p>相连是一种自反的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#reflexive" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#reflexive'); return false;">reflexive</a>]、对称的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#symmetric" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#symmetric'); return false;">symmetric</a>]关系。</p>
<div id="highlighter_450261" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_450261_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_450261" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).isConnected(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns true</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">9</code><code class="plain">).isConnected(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">)); </code><code class="comments">// returns true</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">5</code><code class="plain">).isConnected(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">9</code><code class="plain">)); </code><code class="comments">// returns true</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).isConnected(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns false</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">5</code><code class="plain">).isConnected(Range.closed(</code><code class="value">6</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns false</code></td></tr></tbody></table></div></div></div>
<p><strong>交集[intersection]</strong></p>
<p><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#intersection(com.google.common.collect.Range)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#intersection(com.google.common.collect.Range)'); return false;"><tt>Range.intersection(Range)</tt></a>返回两个区间的交集：既包含于第一个区间，又包含于另一个区间的最大区间。当且仅当两个区间是相连的，它们才有交集。如果两个区间没有交集，该方法将抛出IllegalArgumentException<tt>。</tt></p>
<p>交集是可互换的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#commutative" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#commutative'); return false;">commutative</a>] 、关联的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#associative" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#associative'); return false;">associative</a>] 运算[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#binary_operation" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#binary_operation'); return false;">operation</a>]。</p>
<div id="highlighter_354483" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_354483_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_354483" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).intersection(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns (5, 5]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">9</code><code class="plain">).intersection(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">)); </code><code class="comments">// returns [3, 4]</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">5</code><code class="plain">).intersection(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">9</code><code class="plain">)); </code><code class="comments">// returns [3, 5]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).intersection(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// throws IAE</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">5</code><code class="plain">).intersection(Range.closed(</code><code class="value">6</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// throws IAE</code></td></tr></tbody></table></div></div></div>
<p><strong>跨区间[span]</strong></p>
<p><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#span(com.google.common.collect.Range)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#span(com.google.common.collect.Range)'); return false;"><tt>Range.span(Range)</tt></a>返回”同时包括两个区间的最小区间”，如果两个区间相连，那就是它们的并集。</p>
<p>span是可互换的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#commutative" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#commutative'); return false;">commutative</a>] 、关联的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#associative" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#associative'); return false;">associative</a>] 、闭合的[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#closed" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#closed'); return false;">closed</a>]运算[<a href="http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#binary_operation" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/GuavaTermsExplained#binary_operation'); return false;">operation</a>]。</p>
<div id="highlighter_898076" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_898076_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_898076" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).span(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns [3, 10)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">9</code><code class="plain">).span(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">)); </code><code class="comments">// returns [0, 9]</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">0</code><code class="plain">, </code><code class="value">5</code><code class="plain">).span(Range.closed(</code><code class="value">3</code><code class="plain">, </code><code class="value">9</code><code class="plain">)); </code><code class="comments">// returns [0, 9]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Range.open(</code><code class="value">3</code><code class="plain">, </code><code class="value">5</code><code class="plain">).span(Range.open(</code><code class="value">5</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns (3, 10)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">Range.closed(</code><code class="value">1</code><code class="plain">, </code><code class="value">5</code><code class="plain">).span(Range.closed(</code><code class="value">6</code><code class="plain">, </code><code class="value">10</code><code class="plain">)); </code><code class="comments">// returns [1, 10]</code></td></tr></tbody></table></div></div></div>
<h2>离散域</h2>
<p>部分（但不是全部）可比较类型是离散的，即区间的上下边界都是可枚举的。</p>
<p>在Guava中，用<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/DiscreteDomain.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/DiscreteDomain.html'); return false;">DiscreteDomain&lt;C&gt;</a>实现类型C的离散形式操作。一个离散域总是代表某种类型值的全集；它不能代表类似”素数”、”长度为5的字符串”或”午夜的时间戳”这样的局部域。</p>
<p><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/DiscreteDomain.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/DiscreteDomain.html'); return false;">DiscreteDomain</a>提供的离散域实例包括：</p>
<table width="236" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="123"><b>类型</b><b></b></td>
<td width="113"><b>离散域</b><b></b></td>
</tr>
<tr>
<td width="123">Integer</td>
<td width="113"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/DiscreteDomain.html#integers()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/DiscreteDomain.html#integers()'); return false;">integers()</a></td>
</tr>
<tr>
<td width="123">Long</td>
<td width="113"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/DiscreteDomain.html#longs()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/DiscreteDomain.html#longs()'); return false;">longs()</a></td>
</tr>
</tbody>
</table>
<p>一旦获取了DiscreteDomain实例，你就可以使用下面的Range运算方法：</p>
<ul>
<li><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ContiguousSet.html#create(com.google.common.collect.Range, com.google.common.collect.DiscreteDomain)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ContiguousSet.html#create(com.google.common.collect.Range, com.google.common.collect.DiscreteDomain)'); return false;">ContiguousSet.create(range, domain)</a>：用ImmutableSortedSet&lt;C&gt;形式表示Range&lt;C&gt;中符合离散域定义的元素，并增加一些额外操作——<i>译者注：实际返回</i><i>ImmutableSortedSet</i><i>的子类</i><i>ContiguousSet</i>。（对无限区间不起作用，除非类型C本身是有限的，比如int就是可枚举的）</li>
<li><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#canonical(com.google.common.collect.DiscreteDomain)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Range.html#canonical(com.google.common.collect.DiscreteDomain)'); return false;">canonical(domain)</a>：把离散域转为区间的”规范形式”。如果ContiguousSet.create(a, domain).equals(ContiguousSet.create(b, domain))并且!a.isEmpty()，则有a.canonical(domain).equals(b.canonical(domain))。（这并不意味着a.equals(b)）</li>
</ul>
<div id="highlighter_108321" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_108321_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_108321" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">ImmutableSortedSet set = ContigousSet.create(Range.open(</code><code class="value">1</code><code class="plain">, </code><code class="value">5</code><code class="plain">), iscreteDomain.integers());</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="comments">//set包含[2, 3, 4]</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">ContiguousSet.create(Range.greaterThan(</code><code class="value">0</code><code class="plain">), DiscreteDomain.integers());</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="comments">//set包含[1, 2, ..., Integer.MAX_VALUE]</code></td></tr></tbody></table></div></div></div>
<p>注意，ContiguousSet.create并没有真的构造了整个集合，而是返回了set形式的区间视图。</p>
<h3>你自己的离散域</h3>
<p>你可以创建自己的离散域，但必须记住DiscreteDomain契约的几个重要方面。</p>
<ul>
<li>一个离散域总是代表某种类型值的全集；它不能代表类似”素数”或”长度为5的字符串”这样的局部域。所以举例来说，你无法构造一个DiscreteDomain以表示精确到秒的JODA DateTime日期集合：因为那将无法包含JODA DateTime的所有值。</li>
<li>DiscreteDomain可能是无限的——比如BigInteger DiscreteDomain。这种情况下，你应当用minValue()和maxValue()的默认实现，它们会抛出NoSuchElementException。但Guava禁止把无限区间传入ContiguousSet.create——<i>译者注：那明显得不到一个可枚举的集合。</i><i></i></li>
</ul>
<h2>如果我需要一个Comparator呢？</h2>
<p>我们想要在Range的可用性与API复杂性之间找到特定的平衡，这部分导致了我们没有提供基于Comparator的接口：我们不需要操心区间是怎样基于不同Comparator互动的；所有API签名都是简单明确的；这样更好。</p>
<p>另一方面，如果你需要任意Comparator，可以按下列其中一项来做：</p>
<ul>
<li>使用通用的Predicate接口，而不是Range类。（Range实现了Predicate接口，因此可以用Predicates.compose(range, function)获取Predicate实例）</li>
<li>使用包装类以定义期望的排序。</li>
</ul>
<p><i>译者注：实际上Range规定元素类型必须是Comparable，这已经满足了大多数需求。如果需要自定义特殊的比较逻辑，可以用Predicates.compose(range, function)组合比较的function。</i>
</p><div style="margin-top: 15px; font-style: italic">
