<div class="post">
     <h3 class="title"><span>[Google Guava] 2.3-强大的集合工具类：java.util.Collections中未包含的集合工具</span></h3>
     <div class="post_content">
      <p><a href="http://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained'); return false;">原文链接</a>&nbsp;<a href="http://ifeve.com/google-guava-collectionutilities" onclick="javascript:window.open('http://ifeve.com/google-guava-collectionutilities'); return false;">译文链接</a>&nbsp;译者：沈义扬，校对：丁一</p>
<p><i>尚未完成: Queues, Tables工具类</i></p>
<p>任何对JDK集合框架有经验的程序员都熟悉和喜欢<a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html" onclick="javascript:window.open('http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html'); return false;"><tt>java.util.Collections</tt></a>包含的工具方法。Guava沿着这些路线提供了更多的工具方法：适用于所有集合的静态方法。这是Guava最流行和成熟的部分之一。</p>
<p>我们用相对直观的方式把工具类与特定集合接口的对应关系归纳如下：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="96"><b>集合接口</b><b></b></td>
<td width="144"><b>属于</b><b>JDK</b><b>还是</b><b>Guava</b></td>
<td width="372"><b>对应的</b><b>Guava</b><b>工具类</b><b></b></td>
</tr>
<tr>
<td width="96">Collection</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Collections2.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Collections2.html'); return false;"><tt>Collections2</tt></a>：不要和java.util.Collections混淆</td>
</tr>
<tr>
<td width="96">List</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Lists.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Lists.html'); return false;"><tt>Lists</tt></a></td>
</tr>
<tr>
<td width="96">Set</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html'); return false;"><tt>Sets</tt></a></td>
</tr>
<tr>
<td width="96">SortedSet</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html'); return false;"><tt>Sets</tt></a></td>
</tr>
<tr>
<td width="96">Map</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html'); return false;"><tt>Maps</tt></a></td>
</tr>
<tr>
<td width="96">SortedMap</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html'); return false;"><tt>Maps</tt></a></td>
</tr>
<tr>
<td width="96">Queue</td>
<td width="144">JDK</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Queues.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Queues.html'); return false;"><tt>Queues</tt></a></td>
</tr>
<tr>
<td width="96"><a href="http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset'); return false;">Multiset</a></td>
<td width="144">Guava</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html'); return false;"><tt>Multisets</tt></a></td>
</tr>
<tr>
<td width="96"><a href="http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap'); return false;">Multimap</a></td>
<td width="144">Guava</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html'); return false;"><tt>Multimaps</tt></a></td>
</tr>
<tr>
<td width="96"><a href="http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#BiMap" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#BiMap'); return false;">BiMap</a></td>
<td width="144">Guava</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html'); return false;"><tt>Maps</tt></a></td>
</tr>
<tr>
<td width="96"><a href="http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Table" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Table'); return false;">Table</a></td>
<td width="144">Guava</td>
<td width="372"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html'); return false;"><tt>Tables</tt></a></td>
</tr>
</tbody>
</table>
<p><i>在找类似转化、过滤的方法？请看第四章，函数式风格。</i><br>
<span id="more-8928"></span></p>
<h2>静态工厂方法</h2>
<p>在JDK 7之前，构造新的范型集合时要讨厌地重复声明范型：</p>
<div id="highlighter_88224" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_88224_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_88224" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List&lt;TypeThatsTooLongForItsOwnGood&gt; list = </code><code class="keyword">new</code> <code class="plain">ArrayList&lt;TypeThatsTooLongForItsOwnGood&gt;();</code></td></tr></tbody></table></div></div></div>
<p>我想我们都认为这很讨厌。因此Guava提供了能够推断范型的静态工厂方法：</p>
<div id="highlighter_898531" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_898531_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_898531" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List&lt;TypeThatsTooLongForItsOwnGood&gt; list = Lists.newArrayList();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Map&lt;KeyType, LongishValueType&gt; map = Maps.newLinkedHashMap();</code></td></tr></tbody></table></div></div></div>
<p>可以肯定的是，JDK7版本的钻石操作符(&lt;&gt;)没有这样的麻烦：</p>
<div id="highlighter_521868" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_521868_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_521868" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List&lt;TypeThatsTooLongForItsOwnGood&gt; list = </code><code class="keyword">new</code> <code class="plain">ArrayList&lt;&gt;();</code></td></tr></tbody></table></div></div></div>
<p>但Guava的静态工厂方法远不止这么简单。用工厂方法模式，我们可以方便地在初始化时就指定起始元素。</p>
<div id="highlighter_268418" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_268418_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_268418" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Set&lt;Type&gt; copySet = Sets.newHashSet(elements);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">List&lt;String&gt; theseElements = Lists.newArrayList(</code><code class="string">"alpha"</code><code class="plain">, </code><code class="string">"beta"</code><code class="plain">, </code><code class="string">"gamma"</code><code class="plain">);</code></td></tr></tbody></table></div></div></div>
<p>此外，通过为工厂方法命名（Effective Java第一条），我们可以提高集合初始化大小的可读性：</p>
<div id="highlighter_452584" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_452584_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_452584" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List&lt;Type&gt; exactly100 = Lists.newArrayListWithCapacity(</code><code class="value">100</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">List&lt;Type&gt; approx100 = Lists.newArrayListWithExpectedSize(</code><code class="value">100</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Set&lt;Type&gt; approx100Set = Sets.newHashSetWithExpectedSize(</code><code class="value">100</code><code class="plain">);</code></td></tr></tbody></table></div></div></div>
<p>确切的静态工厂方法和相应的工具类一起罗列在下面的章节。</p>
<p>注意：Guava引入的新集合类型没有暴露原始构造器，也没有在工具类中提供初始化方法。而是直接在集合类中提供了静态工厂方法，例如：</p>
<div id="highlighter_127590" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_127590_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_127590" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Multiset&lt;String&gt; multiset = HashMultiset.create();</code></td></tr></tbody></table></div></div></div>
<h2>Iterables</h2>
<p>在可能的情况下，Guava提供的工具方法更偏向于接受Iterable而不是Collection类型。在Google，对于不存放在主存的集合——比如从数据库或其他数据中心收集的结果集，因为实际上还没有攫取全部数据，这类结果集都不能支持类似size()的操作 ——通常都不会用Collection类型来表示。</p>
<p>因此，很多你期望的支持所有集合的操作都在<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html'); return false;"><tt>Iterables</tt></a>类中。大多数Iterables方法有一个在<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterators.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterators.html'); return false;">Iterators</a>类中的对应版本，用来处理Iterator。</p>
<p>截至Guava 1.2版本，Iterables使用<tt><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html'); return false;">FluentIterable</a>类</tt>进行了补充，它包装了一个Iterable实例，并对许多操作提供了”fluent”（链式调用）语法。</p>
<p>下面列出了一些最常用的工具方法，但更多Iterables的函数式方法将在第四章讨论。</p>
<h3>常规方法</h3>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#concat(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#concat(java.lang.Iterable)'); return false;"><tt>concat(Iterable&lt;Iterable&gt;)</tt></a></td>
<td width="222">串联多个iterables的懒视图*</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#concat(java.lang.Iterable...)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#concat(java.lang.Iterable...)'); return false;"><tt>concat(Iterable...)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#frequency(java.lang.Iterable, java.lang.Object)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#frequency(java.lang.Iterable, java.lang.Object)'); return false;"><tt>frequency(Iterable, Object)</tt></a></td>
<td width="222">返回对象在iterable中出现的次数</td>
<td width="211">与Collections.frequency (Collection, &nbsp; Object)比较；<tt></tt><a href="http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset" onclick="javascript:window.open('http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset'); return false;">Multiset</a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#partition(java.lang.Iterable, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#partition(java.lang.Iterable, int)'); return false;"><tt>partition(Iterable, int)</tt></a></td>
<td width="222">把iterable按指定大小分割，得到的子集都不能进行修改操作</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#partition(java.util.List, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#partition(java.util.List, int)'); return false;"><tt>Lists.partition(List, int)</tt></a>；<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#paddedPartition(java.lang.Iterable, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#paddedPartition(java.lang.Iterable, int)'); return false;"><tt>paddedPartition(Iterable, int)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getFirst(java.lang.Iterable, T)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getFirst(java.lang.Iterable, T)'); return false;"><tt>getFirst(Iterable, T default)</tt></a></td>
<td width="222">返回iterable的第一个元素，若iterable为空则返回默认值</td>
<td width="211">与Iterable.iterator(). next()比较;<a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#first()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#first()'); return false;"><tt>FluentIterable.first()</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getLast(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getLast(java.lang.Iterable)'); return false;"><tt>getLast(Iterable)</tt></a></td>
<td width="222">返回iterable的最后一个元素，若iterable为空则抛出NoSuchElementException</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getLast(java.lang.Iterable, T)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getLast(java.lang.Iterable, T)'); return false;"><tt>getLast(Iterable, T default)</tt></a>；<br>
<a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#last()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#last()'); return false;"><tt>FluentIterable.last()</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#elementsEqual(java.lang.Iterable, java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#elementsEqual(java.lang.Iterable, java.lang.Iterable)'); return false;"><tt>elementsEqual(Iterable, Iterable)</tt></a></td>
<td width="222">如果两个iterable中的所有元素相等且顺序一致，返回true</td>
<td width="211">与List.equals(Object)比较</td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#unmodifiableIterable(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#unmodifiableIterable(java.lang.Iterable)'); return false;"><tt>unmodifiableIterable(Iterable)</tt></a></td>
<td width="222">返回iterable的不可变视图</td>
<td width="211">与Collections. unmodifiableCollection(Collection)比较</td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#limit(java.lang.Iterable, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#limit(java.lang.Iterable, int)'); return false;"><tt>limit(Iterable, int)</tt></a></td>
<td width="222">限制iterable的元素个数限制给定值</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#limit(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#limit(int)'); return false;"><tt>FluentIterable.limit(int)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getOnlyElement(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getOnlyElement(java.lang.Iterable)'); return false;"><tt>getOnlyElement(Iterable)</tt></a></td>
<td width="222">获取iterable中唯一的元素，如果iterable为空或有多个元素，则快速失败</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getOnlyElement(java.lang.Iterable, T)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#getOnlyElement(java.lang.Iterable, T)'); return false;"><tt>getOnlyElement(Iterable, T default)</tt></a></td>
</tr>
</tbody>
</table>
<p><i>*译者注：懒视图意味着如果还没访问到某个iterable中的元素，则不会对它进行串联操作。</i></p>
<div id="highlighter_646860" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_646860_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_646860" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Iterable&lt;Integer&gt; concatenated = Iterables.concat(</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Ints.asList(</code><code class="value">1</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="value">3</code><code class="plain">),</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Ints.asList(</code><code class="value">4</code><code class="plain">, </code><code class="value">5</code><code class="plain">, </code><code class="value">6</code><code class="plain">)); </code><code class="comments">// concatenated包括元素 1, 2, 3, 4, 5, 6</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">String lastAdded = Iterables.getLast(myLinkedHashSet);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">String theElement = Iterables.getOnlyElement(thisSetIsDefinitelyASingleton);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="comments">//如果set不是单元素集，就会出错了！</code></td></tr></tbody></table></div></div></div>
<h3>与Collection方法相似的工具方法</h3>
<p>通常来说，Collection的实现天然支持操作其他Collection，但却不能操作Iterable。</p>
<p>下面的方法中，如果传入的Iterable是一个Collection实例，则实际操作将会委托给相应的Collection接口方法。例如，往Iterables.size方法传入是一个Collection实例，它不会真的遍历iterator获取大小，而是直接调用Collection.size。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="186"><b>方法</b><b></b></td>
<td width="222"><b>类似的</b><b>Collection</b><b>方法</b><b></b></td>
<td width="211"><b>等价的</b><b>FluentIterable</b><b>方法</b><b></b></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#addAll(java.util.Collection, java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#addAll(java.util.Collection, java.lang.Iterable)'); return false;"><tt>addAll(Collection addTo, &nbsp; Iterable toAdd)</tt></a></td>
<td width="222">Collection.addAll(Collection)</td>
<td width="211"></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#contains(java.lang.Iterable, java.lang.Object)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#contains(java.lang.Iterable, java.lang.Object)'); return false;"><tt>contains(Iterable, Object)</tt></a></td>
<td width="222">Collection.contains(Object)</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#contains(java.lang.Object)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#contains(java.lang.Object)'); return false;"><tt>FluentIterable.contains(Object)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#removeAll(java.lang.Iterable, java.util.Collection)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#removeAll(java.lang.Iterable, java.util.Collection)'); return false;"><tt>removeAll(Iterable &nbsp; removeFrom, Collection toRemove)</tt></a></td>
<td width="222">Collection.removeAll(Collection)</td>
<td width="211"></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#retainAll(java.lang.Iterable, java.util.Collection)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#retainAll(java.lang.Iterable, java.util.Collection)'); return false;"><tt>retainAll(Iterable &nbsp; removeFrom, Collection toRetain)</tt></a></td>
<td width="222">Collection.retainAll(Collection)</td>
<td width="211"></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#size(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#size(java.lang.Iterable)'); return false;"><tt>size(Iterable)</tt></a></td>
<td width="222">Collection.size()</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#size()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#size()'); return false;"><tt>FluentIterable.size()</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#toArray(java.lang.Iterable, java.lang.Class)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#toArray(java.lang.Iterable, java.lang.Class)'); return false;"><tt>toArray(Iterable, Class)</tt></a></td>
<td width="222">Collection.toArray(T[])</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toArray(java.lang.Class)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toArray(java.lang.Class)'); return false;"><tt>FluentIterable.toArray(Class)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#isEmpty(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#isEmpty(java.lang.Iterable)'); return false;"><tt>isEmpty(Iterable)</tt></a></td>
<td width="222">Collection.isEmpty()</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#isEmpty()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#isEmpty()'); return false;"><tt>FluentIterable.isEmpty()</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#get(java.lang.Iterable, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#get(java.lang.Iterable, int)'); return false;"><tt>get(Iterable, int)</tt></a></td>
<td width="222">List.get(int)</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-%20history/release12/javadoc/com/google/common/collect/FluentIterable.html#get(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-%20history/release12/javadoc/com/google/common/collect/FluentIterable.html#get(int)'); return false;"><tt>FluentIterable.get(int)</tt></a></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#toString(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Iterables.html#toString(java.lang.Iterable)'); return false;"><tt>toString(Iterable)</tt></a></td>
<td width="222">Collection.toString()</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toString()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toString()'); return false;"><tt>FluentIterable.toString()</tt></a></td>
</tr>
</tbody>
</table>
<h3>FluentIterable</h3>
<p>除了上面和第四章提到的方法，FluentIterable还有一些便利方法用来把自己拷贝到不可变集合</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="186">ImmutableList</td>
<td width="282"></td>
</tr>
<tr>
<td width="186">ImmutableSet</td>
<td width="282"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toImmutableSet()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toImmutableSet()'); return false;"><tt>toImmutableSet()</tt></a></td>
</tr>
<tr>
<td width="186">ImmutableSortedSet</td>
<td width="282"><a href="http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toImmutableSortedSet(java.util.Comparator)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release12/javadoc/com/google/common/collect/FluentIterable.html#toImmutableSortedSet(java.util.Comparator)'); return false;"><tt>toImmutableSortedSet(Comparator)</tt></a></td>
</tr>
</tbody>
</table>
<h2>Lists</h2>
<p>除了静态工厂方法和函数式编程方法，<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Lists.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Lists.html'); return false;"><tt>Lists</tt></a>为List类型的对象提供了若干工具方法。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="186"><b>方法</b><b></b></td>
<td width="426"><b>描述</b><b></b></td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#partition(java.util.List, int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#partition(java.util.List, int)'); return false;"><tt>partition(List, int)</tt></a></td>
<td width="426">把List按指定大小分割</td>
</tr>
<tr>
<td width="186"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#reverse(java.util.List)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#reverse(java.util.List)'); return false;"><tt>reverse(List)</tt></a></td>
<td width="426">返回给定List的反转视图。注: 如果List是不可变的，考虑改用<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableList.html#reverse()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableList.html#reverse()'); return false;"><tt>ImmutableList.reverse()</tt></a>。</td>
</tr>
</tbody>
</table>
<div id="highlighter_711598" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_711598_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_711598" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">List countUp = Ints.asList(</code><code class="value">1</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="value">3</code><code class="plain">, </code><code class="value">4</code><code class="plain">, </code><code class="value">5</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">List countDown = Lists.reverse(theList); </code><code class="comments">// {5, 4, 3, 2, 1}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">List&lt;List&gt; parts = Lists.partition(countUp, </code><code class="value">2</code><code class="plain">);</code><code class="comments">//{{1,2}, {3,4}, {5}}</code></td></tr></tbody></table></div></div></div>
<h3>静态工厂方法</h3>
<p>Lists提供如下静态工厂方法：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="108"><b>具体实现类型</b><b></b></td>
<td width="504"><b>工厂方法</b><b></b></td>
</tr>
<tr>
<td width="108">ArrayList</td>
<td width="504"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(E...)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(E...)'); return false;">with elements</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(java.lang.Iterable)'); return false;">from <tt>Iterable</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayListWithCapacity(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayListWithCapacity(int)'); return false;">with exact capacity</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayListWithExpectedSize(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayListWithExpectedSize(int)'); return false;">with expected size</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(java.util.Iterator)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newArrayList(java.util.Iterator)'); return false;">from <tt>Iterator</tt></a></td>
</tr>
<tr>
<td width="108">LinkedList</td>
<td width="504"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newLinkedList()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newLinkedList()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newLinkedList(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html#newLinkedList(java.lang.Iterable)'); return false;">from <tt>Iterable</tt></a></td>
</tr>
</tbody>
</table>
<h2>Sets</h2>
<p><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html'); return false;"><tt>Sets</tt></a>工具类包含了若干好用的方法。</p>
<h3>集合理论方法</h3>
<p>我们提供了很多标准的集合运算（Set-Theoretic）方法，这些方法接受Set参数并返回<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html'); return false;"><tt>SetView</tt></a>，可用于：</p>
<ul>
<li>直接当作Set使用，因为SetView也实现了Set接口；</li>
<li>用<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html#copyInto(S)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html#copyInto(S)'); return false;"><tt>copyInto(Set)</tt></a>拷贝进另一个可变集合；</li>
<li>用<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html#immutableCopy()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.SetView.html#immutableCopy()'); return false;"><tt>immutableCopy()</tt></a>对自己做不可变拷贝。</li>
</ul>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="252"><b>方法</b><b></b></td>
</tr>
<tr>
<td width="252"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#union(java.util.Set, java.util.Set)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#union(java.util.Set, java.util.Set)'); return false;"><tt>union(Set, Set)</tt></a></td>
</tr>
<tr>
<td width="252"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#intersection(java.util.Set, java.util.Set)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#intersection(java.util.Set, java.util.Set)'); return false;"><tt>intersection(Set, Set)</tt></a></td>
</tr>
<tr>
<td width="252"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#difference(java.util.Set, java.util.Set)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#difference(java.util.Set, java.util.Set)'); return false;"><tt>difference(Set, Set)</tt></a></td>
</tr>
<tr>
<td width="252"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#symmetricDifference(java.util.Set, java.util.Set)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#symmetricDifference(java.util.Set, java.util.Set)'); return false;"><tt>symmetricDifference(Set, &nbsp; Set)</tt></a></td>
</tr>
</tbody>
</table>
<p>使用范例：</p>
<div id="highlighter_516919" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_516919_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_516919" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Set&lt;String&gt; wordsWithPrimeLength = ImmutableSet.of(</code><code class="string">"one"</code><code class="plain">, </code><code class="string">"two"</code><code class="plain">, </code><code class="string">"three"</code><code class="plain">, </code><code class="string">"six"</code><code class="plain">, </code><code class="string">"seven"</code><code class="plain">, </code><code class="string">"eight"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Set&lt;String&gt; primes = ImmutableSet.of(</code><code class="string">"two"</code><code class="plain">, </code><code class="string">"three"</code><code class="plain">, </code><code class="string">"five"</code><code class="plain">, </code><code class="string">"seven"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">SetView&lt;String&gt; intersection = Sets.intersection(primes,wordsWithPrimeLength);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="comments">// intersection包含"two", "three", "seven"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="keyword">return</code> <code class="plain">intersection.immutableCopy();</code><code class="comments">//可以使用交集，但不可变拷贝的读取效率更高</code></td></tr></tbody></table></div></div></div>
<h3>其他Set工具方法</h3>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="228"><b>方法</b><b></b></td>
<td width="180"><b>描述</b><b></b></td>
<td width="211"><b>另请参见</b><b></b></td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#cartesianProduct(java.util.List)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#cartesianProduct(java.util.List)'); return false;"><tt>cartesianProduct(List&lt;Set&gt;)</tt></a></td>
<td width="180">返回所有集合的笛卡儿积</td>
<td width="211"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#cartesianProduct(java.util.Set...)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#cartesianProduct(java.util.Set...)'); return false;"><tt>cartesianProduct(Set...)</tt></a></td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#powerSet(java.util.Set)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#powerSet(java.util.Set)'); return false;"><tt>powerSet(Set)</tt></a></td>
<td width="180">返回给定集合的所有子集</td>
<td width="211"></td>
</tr>
</tbody>
</table>
<div id="highlighter_771386" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_771386_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_771386" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Set&lt;String&gt; animals = ImmutableSet.of(</code><code class="string">"gerbil"</code><code class="plain">, </code><code class="string">"hamster"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Set&lt;String&gt; fruits = ImmutableSet.of(</code><code class="string">"apple"</code><code class="plain">, </code><code class="string">"orange"</code><code class="plain">, </code><code class="string">"banana"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Set&lt;List&lt;String&gt;&gt; product = Sets.cartesianProduct(animals, fruits);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="comments">// {{"gerbil", "apple"}, {"gerbil", "orange"}, {"gerbil", "banana"},</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="comments">// &nbsp;{"hamster", "apple"}, {"hamster", "orange"}, {"hamster", "banana"}}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">Set&lt;Set&lt;String&gt;&gt; animalSets = Sets.powerSet(animals);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="comments">// {{}, {"gerbil"}, {"hamster"}, {"gerbil", "hamster"}}</code></td></tr></tbody></table></div></div></div>
<h3>静态工厂方法</h3>
<p>Sets提供如下静态工厂方法：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="120"><b>具体实现类型</b><b></b></td>
<td width="492"><b>工厂方法</b><b></b></td>
</tr>
<tr>
<td width="120">HashSet</td>
<td width="492"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(E...)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(E...)'); return false;">with elements</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(java.lang.Iterable)'); return false;">from <tt>Iterable</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSetWithExpectedSize(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSetWithExpectedSize(int)'); return false;">with expected size</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(java.util.Iterator)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newHashSet(java.util.Iterator)'); return false;">from <tt>Iterator</tt></a></td>
</tr>
<tr>
<td width="120">LinkedHashSet</td>
<td width="492"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSet()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSet()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSet(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSet(java.lang.Iterable)'); return false;">from <tt>Iterable</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSetWithExpectedSize(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newLinkedHashSetWithExpectedSize(int)'); return false;">with expected size</a></td>
</tr>
<tr>
<td width="120">TreeSet</td>
<td width="492"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet(java.util.Comparator)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet(java.util.Comparator)'); return false;">with <tt>Comparator</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet(java.lang.Iterable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html#newTreeSet(java.lang.Iterable)'); return false;">from <tt>Iterable</tt></a></td>
</tr>
</tbody>
</table>
<h2>Maps</h2>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html'); return false;"><tt>Maps</tt></a>类有若干值得单独说明的、很酷的方法。</p>
<h3>uniqueIndex</h3>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#uniqueIndex(java.lang.Iterable, com.google.common.base.Function)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#uniqueIndex(java.lang.Iterable, com.google.common.base.Function)'); return false;"><tt>Maps.uniqueIndex(Iterable,Function)</tt></a>通常针对的场景是：有一组对象，它们在某个属性上分别有独一无二的值，而我们希望能够按照这个属性值查找对象——<i>译者注：这个方法返回一个</i><i>Map，键为Function返回的属性值，值为Iterable中相应的元素，因此我们可以反复用这个Map进行查找操作。</i></p>
<p>比方说，我们有一堆字符串，这些字符串的长度都是独一无二的，而我们希望能够按照特定长度查找字符串：</p>
<div id="highlighter_64351" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_64351_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_64351" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">ImmutableMap&lt;Integer, String&gt; stringsByIndex = Maps.uniqueIndex(strings,</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">new</code> <code class="plain">Function&lt;String, Integer&gt; () {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="plain">Integer apply(String string) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">string.length();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">});</code></td></tr></tbody></table></div></div></div>
<p>如果索引值不是独一无二的，请参见下面的Multimaps.index方法。</p>
<h3>difference</h3>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#difference(java.util.Map, java.util.Map)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#difference(java.util.Map, java.util.Map)'); return false;"><tt>Maps.difference(Map, Map)</tt></a>用来比较两个Map以获取所有不同点。该方法返回MapDifference对象，把不同点的维恩图分解为：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="174"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesInCommon()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesInCommon()'); return false;"><tt>entriesInCommon()</tt></a></td>
<td width="438">两个Map中都有的映射项，包括匹配的键与值</td>
</tr>
<tr>
<td width="174"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesDiffering()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesDiffering()'); return false;"><tt>entriesDiffering()</tt></a></td>
<td width="438">键相同但是值不同值映射项。返回的Map的值类型为<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.ValueDifference.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.ValueDifference.html'); return false;"><tt>MapDifference.ValueDifference</tt></a>，以表示左右两个不同的值</td>
</tr>
<tr>
<td width="174"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesOnlyOnLeft()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesOnlyOnLeft()'); return false;"><tt>entriesOnlyOnLeft()</tt></a></td>
<td width="438">键只存在于左边Map的映射项</td>
</tr>
<tr>
<td width="174"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesOnlyOnRight()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/MapDifference.html#entriesOnlyOnRight()'); return false;"><tt>entriesOnlyOnRight()</tt></a></td>
<td width="438">键只存在于右边Map的映射项</td>
</tr>
</tbody>
</table>
<div id="highlighter_335240" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_335240_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_335240" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Map&lt;String, Integer&gt; left = ImmutableMap.of(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">1</code><code class="plain">, </code><code class="string">"b"</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="string">"c"</code><code class="plain">, </code><code class="value">3</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Map&lt;String, Integer&gt; left = ImmutableMap.of(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">1</code><code class="plain">, </code><code class="string">"b"</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="string">"c"</code><code class="plain">, </code><code class="value">3</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">MapDifference&lt;String, Integer&gt; diff = Maps.difference(left, right);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">diff.entriesInCommon(); </code><code class="comments">// {"b" =&gt; 2}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">diff.entriesInCommon(); </code><code class="comments">// {"b" =&gt; 2}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">diff.entriesOnlyOnLeft(); </code><code class="comments">// {"a" =&gt; 1}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">diff.entriesOnlyOnRight(); </code><code class="comments">// {"d" =&gt; 5}</code></td></tr></tbody></table></div></div></div>
<h3>处理BiMap的工具方法</h3>
<p>Guava中处理BiMap的工具方法在Maps类中，因为BiMap也是一种Map实现。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="300"><b>BiMap</b><b>工具方法</b><b></b></td>
<td width="312"><b>相应的</b><b>Map</b><b>工具方法</b><b></b></td>
</tr>
<tr>
<td width="300"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#synchronizedBiMap(com.google.common.collect.BiMap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#synchronizedBiMap(com.google.common.collect.BiMap)'); return false;"><tt>synchronizedBiMap(BiMap)</tt></a></td>
<td width="312">Collections.synchronizedMap(Map)</td>
</tr>
<tr>
<td width="300"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#unmodifiableBiMap(com.google.common.collect.BiMap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#unmodifiableBiMap(com.google.common.collect.BiMap)'); return false;"><tt>unmodifiableBiMap(BiMap)</tt> </a></td>
<td width="312">Collections.unmodifiableMap(Map)</td>
</tr>
</tbody>
</table>
<h3>静态工厂方法</h3>
<p>Maps提供如下静态工厂方法：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="300"><b>具体实现类型</b><b></b></td>
<td width="312"><b>工厂方法</b><b></b></td>
</tr>
<tr>
<td width="300">HashMap</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMap()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMap()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMap(java.util.Map)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMap(java.util.Map)'); return false;">from <tt>Map</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMapWithExpectedSize(int)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newHashMapWithExpectedSize(int)'); return false;">with expected size</a></td>
</tr>
<tr>
<td width="300">LinkedHashMap</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newLinkedHashMap()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newLinkedHashMap()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newLinkedHashMap(java.util.Map)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newLinkedHashMap(java.util.Map)'); return false;">from <tt>Map</tt></a></td>
</tr>
<tr>
<td width="300">TreeMap</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap()'); return false;">basic</a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap(java.util.Comparator)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap(java.util.Comparator)'); return false;">from <tt>Comparator</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap(java.util.SortedMap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newTreeMap(java.util.SortedMap)'); return false;">from <tt>SortedMap</tt></a></td>
</tr>
<tr>
<td width="300">EnumMap</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newEnumMap(java.lang.Class)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newEnumMap(java.lang.Class)'); return false;">from <tt>Class</tt></a>, <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newEnumMap(java.util.Map)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newEnumMap(java.util.Map)'); return false;">from <tt>Map</tt></a></td>
</tr>
<tr>
<td width="300">ConcurrentMap：支持所有操作</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newConcurrentMap()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newConcurrentMap()'); return false;">basic</a></td>
</tr>
<tr>
<td width="300">IdentityHashMap</td>
<td width="312"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newIdentityHashMap()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html#newIdentityHashMap()'); return false;">basic</a></td>
</tr>
</tbody>
</table>
<h2>Multisets</h2>
<p>标准的Collection操作会忽略Multiset重复元素的个数，而只关心元素是否存在于Multiset中，如containsAll方法。为此，<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multisets.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multisets.html'); return false;"><tt>Multisets</tt></a>提供了若干方法，以顾及Multiset元素的重复性：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="228"><b>方法</b><b></b></td>
<td width="180"><b>说明</b><b></b></td>
<td width="211"><b>和</b><b>Collection</b><b>方法的区别</b><b></b></td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#containsOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#containsOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)'); return false;"><tt>containsOccurrences(Multiset &nbsp; sup, Multiset sub)</tt></a></td>
<td width="180">对任意o，如果sub.count(o)&lt;=super.count(o)，返回true</td>
<td width="211">Collection.containsAll忽略个数，而只关心sub的元素是否都在super中</td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#removeOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#removeOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)'); return false;"><tt>removeOccurrences(Multiset &nbsp; removeFrom, Multiset toRemove)</tt></a></td>
<td width="180">对toRemove中的重复元素，仅在removeFrom中删除相同个数。</td>
<td width="211">Collection.removeAll移除所有出现在toRemove的元素</td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#retainOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#retainOccurrences(com.google.common.collect.Multiset, com.google.common.collect.Multiset)'); return false;"><tt>retainOccurrences(Multiset &nbsp; removeFrom, Multiset toRetain)</tt></a></td>
<td width="180">修改removeFrom，以保证任意o都符合removeFrom.count(o)&lt;=toRetain.count(o)</td>
<td width="211">Collection.retainAll保留所有出现在toRetain的元素</td>
</tr>
<tr>
<td width="228"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#intersection(com.google.common.collect.Multiset, com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#intersection(com.google.common.collect.Multiset, com.google.common.collect.Multiset)'); return false;"><tt>intersection(Multiset, &nbsp; Multiset)</tt></a></td>
<td width="180">返回两个multiset的交集;</td>
<td width="211">没有类似方法</td>
</tr>
</tbody>
</table>
<div id="highlighter_376045" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_376045_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_376045" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">Multiset&lt;String&gt; multiset1 = HashMultiset.create();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">multiset1.add(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="plain">Multiset&lt;String&gt; multiset2 = HashMultiset.create();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">multiset2.add(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">5</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="plain">multiset1.containsAll(multiset2); </code><code class="comments">//返回true；因为包含了所有不重复元素，</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="comments">//虽然multiset1实际上包含2个"a"，而multiset2包含5个"a"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="plain">Multisets.containsOccurrences(multiset1, multiset2); </code><code class="comments">// returns false</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">multiset2.removeOccurrences(multiset1); </code><code class="comments">// multiset2 现在包含3个"a"</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">multiset2.removeAll(multiset1);</code><code class="comments">//multiset2移除所有"a"，虽然multiset1只有2个"a"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="plain">multiset2.isEmpty(); </code><code class="comments">// returns true</code></td></tr></tbody></table></div></div></div>
<p>Multisets中的其他工具方法还包括：</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="342"><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multisets.html#copyHighestCountFirst(com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multisets.html#copyHighestCountFirst(com.google.common.collect.Multiset)'); return false;"><tt>copyHighestCountFirst(Multiset)</tt></a></td>
<td width="270">返回Multiset的不可变拷贝，并将元素按重复出现的次数做降序排列</td>
</tr>
<tr>
<td width="342"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#unmodifiableMultiset(com.google.common.collect.Multiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#unmodifiableMultiset(com.google.common.collect.Multiset)'); return false;"><tt>unmodifiableMultiset(Multiset)</tt></a></td>
<td width="270">返回Multiset的只读视图</td>
</tr>
<tr>
<td width="342"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#unmodifiableSortedMultiset(com.google.common.collect.SortedMultiset)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multisets.html#unmodifiableSortedMultiset(com.google.common.collect.SortedMultiset)'); return false;"><tt>unmodifiableSortedMultiset(SortedMultiset)</tt></a></td>
<td width="270">返回SortedMultiset的只读视图</td>
</tr>
</tbody>
</table>
<div id="highlighter_741539" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_741539_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_741539" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Multiset&lt;String&gt; multiset = HashMultiset.create();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">multiset.add(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">3</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">multiset.add(</code><code class="string">"b"</code><code class="plain">, </code><code class="value">5</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">multiset.add(</code><code class="string">"c"</code><code class="plain">, </code><code class="value">1</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">ImmutableMultiset highestCountFirst = Multisets.copyHighestCountFirst(multiset);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="comments">//highestCountFirst，包括它的entrySet和elementSet，按{"b", "a", "c"}排列元素</code></td></tr></tbody></table></div></div></div>
<h2>Multimaps</h2>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html'); return false;"><tt>Multimaps</tt></a>提供了若干值得单独说明的通用工具方法</p>
<h3>index</h3>
<p>作为Maps.uniqueIndex的兄弟方法，<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#index(java.lang.Iterable, com.google.common.base.Function)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#index(java.lang.Iterable, com.google.common.base.Function)'); return false;"><tt>Multimaps.index(Iterable, Function)</tt></a>通常针对的场景是：有一组对象，它们有共同的特定属性，我们希望按照这个属性的值查询对象，但属性值不一定是独一无二的。</p>
<p>比方说，我们想把字符串按长度分组。</p>
<div id="highlighter_67972" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_67972_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_67972" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">ImmutableSet digits = ImmutableSet.of(</code><code class="string">"zero"</code><code class="plain">, </code><code class="string">"one"</code><code class="plain">, </code><code class="string">"two"</code><code class="plain">, </code><code class="string">"three"</code><code class="plain">, </code><code class="string">"four"</code><code class="plain">, </code><code class="string">"five"</code><code class="plain">, </code><code class="string">"six"</code><code class="plain">, </code><code class="string">"seven"</code><code class="plain">, </code><code class="string">"eight"</code><code class="plain">, </code><code class="string">"nine"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">Function&lt;String, Integer&gt; lengthFunction = </code><code class="keyword">new</code> <code class="plain">Function&lt;String, Integer&gt;() {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="plain">Integer apply(String string) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">string.length();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">ImmutableListMultimap&lt;Integer, String&gt; digitsByLength= Multimaps.index(digits, lengthFunction);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="comments">/*</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="comments">* &nbsp;digitsByLength maps:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="comments">* &nbsp;3 =&gt; {"one", "two", "six"}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="comments">* &nbsp;4 =&gt; {"zero", "four", "five", "nine"}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="comments">* &nbsp;5 =&gt; {"three", "seven", "eight"}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="comments">*/</code></td></tr></tbody></table></div></div></div>
<h3>invertFrom</h3>
<p>鉴于Multimap可以把多个键映射到同一个值（<i>译者注：实际上这是任何</i><i>map都有的特性</i>），也可以把一个键映射到多个值，反转Multimap也会很有用。Guava 提供了<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#invertFrom(com.google.common.collect.Multimap, M)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#invertFrom(com.google.common.collect.Multimap, M)'); return false;"><tt>invertFrom(Multimap toInvert,<br>
Multimap dest)</tt></a>做这个操作，并且你可以自由选择反转后的Multimap实现。</p>
<p>注：如果你使用的是ImmutableMultimap，考虑改用<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableMultimap.html#inverse()" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableMultimap.html#inverse()'); return false;"><tt>ImmutableMultimap.inverse()</tt></a>做反转。</p>
<div id="highlighter_606869" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_606869_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_606869" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">ArrayListMultimap&lt;String, Integer&gt; multimap = ArrayListMultimap.create();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">multimap.putAll(</code><code class="string">"b"</code><code class="plain">, Ints.asList(</code><code class="value">2</code><code class="plain">, </code><code class="value">4</code><code class="plain">, </code><code class="value">6</code><code class="plain">));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">multimap.putAll(</code><code class="string">"a"</code><code class="plain">, Ints.asList(</code><code class="value">4</code><code class="plain">, </code><code class="value">2</code><code class="plain">, </code><code class="value">1</code><code class="plain">));</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="plain">multimap.putAll(</code><code class="string">"c"</code><code class="plain">, Ints.asList(</code><code class="value">2</code><code class="plain">, </code><code class="value">5</code><code class="plain">, </code><code class="value">3</code><code class="plain">));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="plain">TreeMultimap&lt;Integer, String&gt; inverse = Multimaps.invertFrom(multimap, TreeMultimap&lt;String, Integer&gt;.create());</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="comments">//注意我们选择的实现，因为选了TreeMultimap，得到的反转结果是有序的</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="comments">/*</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="comments">* inverse maps:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="comments">* &nbsp;1 =&gt; {"a"}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="comments">* &nbsp;2 =&gt; {"a", "b", "c"}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="comments">* &nbsp;3 =&gt; {"c"}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="comments">* &nbsp;4 =&gt; {"a", "b"}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="comments">* &nbsp;5 =&gt; {"c"}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="comments">* &nbsp;6 =&gt; {"b"}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="comments">*/</code></td></tr></tbody></table></div></div></div>
<h3>forMap</h3>
<p>想在Map对象上使用Multimap的方法吗？<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#forMap(java.util.Map)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#forMap(java.util.Map)'); return false;"><tt>forMap(Map)</tt></a>把Map包装成SetMultimap。这个方法特别有用，例如，与Multimaps.invertFrom结合使用，可以把多对一的Map反转为一对多的Multimap。</p>
<div id="highlighter_447608" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_447608_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_447608" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Map&lt;String, Integer&gt; map = ImmutableMap.of(</code><code class="string">"a"</code><code class="plain">, </code><code class="value">1</code><code class="plain">, </code><code class="string">"b"</code><code class="plain">, </code><code class="value">1</code><code class="plain">, </code><code class="string">"c"</code><code class="plain">, </code><code class="value">2</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">SetMultimap&lt;String, Integer&gt; multimap = Multimaps.forMap(map);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="comments">// multimap：["a" =&gt; {1}, "b" =&gt; {1}, "c" =&gt; {2}]</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">Multimap&lt;Integer, String&gt; inverse = Multimaps.invertFrom(multimap, HashMultimap&lt;Integer, String&gt;.create());</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="comments">// inverse：[1 =&gt; {"a","b"}, 2 =&gt; {"c"}]</code></td></tr></tbody></table></div></div></div>
<h3>包装器</h3>
<p>Multimaps提供了传统的包装方法，以及让你选择Map和Collection类型以自定义Multimap实现的工具方法。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="114">只读包装</td>
<td width="84"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableMultimap(com.google.common.collect.Multimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableMultimap(com.google.common.collect.Multimap)'); return false;"><tt>Multimap</tt></a></td>
<td width="114"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableListMultimap(com.google.common.collect.ListMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableListMultimap(com.google.common.collect.ListMultimap)'); return false;"><tt>ListMultimap</tt></a></td>
<td width="132"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableSetMultimap(com.google.common.collect.SetMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableSetMultimap(com.google.common.collect.SetMultimap)'); return false;"><tt>SetMultimap</tt></a></td>
<td width="168"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableSortedSetMultimap(com.google.common.collect.SortedSetMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#unmodifiableSortedSetMultimap(com.google.common.collect.SortedSetMultimap)'); return false;"><tt>SortedSetMultimap</tt></a></td>
</tr>
<tr>
<td width="114">同步包装</td>
<td width="84"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedMultimap(com.google.common.collect.Multimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedMultimap(com.google.common.collect.Multimap)'); return false;"><tt>Multimap</tt></a></td>
<td width="114"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedListMultimap(com.google.common.collect.ListMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedListMultimap(com.google.common.collect.ListMultimap)'); return false;"><tt>ListMultimap</tt></a></td>
<td width="132"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedSetMultimap(com.google.common.collect.SetMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedSetMultimap(com.google.common.collect.SetMultimap)'); return false;"><tt>SetMultimap</tt></a></td>
<td width="168"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedSortedSetMultimap(com.google.common.collect.SortedSetMultimap)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#synchronizedSortedSetMultimap(com.google.common.collect.SortedSetMultimap)'); return false;"><tt>SortedSetMultimap</tt></a></td>
</tr>
<tr>
<td width="114">自定义实现</td>
<td width="84"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newMultimap(java.util.Map, com.google.common.base.Supplier)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newMultimap(java.util.Map, com.google.common.base.Supplier)'); return false;"><tt>Multimap</tt></a></td>
<td width="114"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newListMultimap(java.util.Map, com.google.common.base.Supplier)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newListMultimap(java.util.Map, com.google.common.base.Supplier)'); return false;"><tt>ListMultimap</tt></a></td>
<td width="132"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newSetMultimap(java.util.Map, com.google.common.base.Supplier)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newSetMultimap(java.util.Map, com.google.common.base.Supplier)'); return false;"><tt>SetMultimap</tt></a></td>
<td width="168"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newSortedSetMultimap(java.util.Map, com.google.common.base.Supplier)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimaps.html#newSortedSetMultimap(java.util.Map, com.google.common.base.Supplier)'); return false;"><tt>SortedSetMultimap</tt></a></td>
</tr>
</tbody>
</table>
<p>自定义Multimap的方法允许你指定Multimap中的特定实现。但要注意的是：</p>
<ul>
<li>Multimap假设对Map和Supplier产生的集合对象有完全所有权。这些自定义对象应避免手动更新，并且在提供给Multimap时应该是空的，此外还不应该使用软引用、弱引用或虚引用。</li>
<li>无法保证修改了Multimap以后，底层Map的内容是什么样的。</li>
<li>即使Map和Supplier产生的集合都是线程安全的，它们组成的Multimap也不能保证并发操作的线程安全性。并发读操作是工作正常的，但需要保证并发读写的话，请考虑用同步包装器解决。</li>
<li>只有当Map、Supplier、Supplier产生的集合对象、以及Multimap存放的键值类型都是可序列化的，Multimap才是可序列化的。</li>
<li>Multimap.get(key)返回的集合对象和Supplier返回的集合对象并不是同一类型。但如果Supplier返回的是随机访问集合，那么Multimap.get(key)返回的集合也是可随机访问的。</li>
</ul>
<p>请注意，用来自定义Multimap的方法需要一个Supplier参数，以创建崭新的集合。下面有个实现ListMultimap的例子——用TreeMap做映射，而每个键对应的多个值用LinkedList存储。</p>
<div id="highlighter_44040" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_44040_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_44040" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">ListMultimap&lt;String, Integer&gt; myMultimap = Multimaps.newListMultimap(</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Maps.&lt;String, Collection&gt;newTreeMap(),</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">new</code> <code class="plain">Supplier&lt;LinkedList&gt;() {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="plain">LinkedList get() {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">Lists.newLinkedList();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">});</code></td></tr></tbody></table></div></div></div>
<h2>Tables</h2>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html'); return false;"><tt>Tables</tt></a>类提供了若干称手的工具方法。</p>
<h3>自定义Table</h3>
<p>堪比Multimaps.newXXXMultimap(Map, Supplier)工具方法，<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#newCustomTable(java.util.Map, com.google.common.base.Supplier)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#newCustomTable(java.util.Map, com.google.common.base.Supplier)'); return false;"><tt>Tables.newCustomTable(Map, Supplier&lt;Map&gt;)</tt></a>允许你指定Table用什么样的map实现行和列。</p>
<div id="highlighter_150052" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="#viewSource" title="查看源代码" class="item viewSource" style="width: 16px; height: 16px;">查看源代码</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_150052_clipboard" type="application/x-shockwave-flash" title="复制到剪贴板" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_150052" menu="false" src="http://ifeve.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter2/scripts/clipboard.swf"></div><a href="#printSource" title="打印" class="item printSource" style="width: 16px; height: 16px;">打印</a><a href="#about" title="帮助" class="item about" style="width: 16px; height: 16px;">帮助</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments">// 使用LinkedHashMaps替代HashMaps</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Table&lt;String, Character, Integer&gt; table = Tables.newCustomTable(</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Maps.&lt;String, Map&lt;Character, Integer&gt;&gt;newLinkedHashMap(),</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="keyword">new</code> <code class="plain">Supplier&lt;Map&lt;Character, Integer&gt;&gt; () {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="keyword">public</code> <code class="plain">Map&lt;Character, Integer&gt; get() {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="keyword">return</code> <code class="plain">Maps.newLinkedHashMap();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">});</code></td></tr></tbody></table></div></div></div>
<h3>transpose</h3>
<p><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#transpose(com.google.common.collect.Table)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#transpose(com.google.common.collect.Table)'); return false;"><tt>transpose(Table&lt;R, C, V&gt;)</tt></a>方法允许你把Table&lt;C, R, V&gt;转置成Table&lt;R, C, V&gt;。例如，如果你在用Table构建加权有向图，这个方法就可以把有向图反转。</p>
<h3>包装器</h3>
<p>还有很多你熟悉和喜欢的Table包装类。然而，在大多数情况下还请使用<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableTable.html" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableTable.html'); return false;"><tt>ImmutableTable</tt></a></p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="108">Unmodifiable</td>
<td width="90"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#unmodifiableTable(com.google.common.collect.Table)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#unmodifiableTable(com.google.common.collect.Table)'); return false;"><tt>Table</tt></a></td>
<td width="150"><a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#unmodifiableRowSortedTable(com.google.common.collect.RowSortedTable)" onclick="javascript:window.open('http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Tables.html#unmodifiableRowSortedTable(com.google.common.collect.RowSortedTable)'); return false;"><tt>RowSortedTable</tt></a></td>
</tr>
</tbody>
</table>
<div style="margin-top: 15px; font-style: italic">
